Methods

In this paper, we proposed a network-based two-step computational method: constructing condition specific subnetworks (STEP 1) and mapping samples into a metric space (STEP 2) (Figure 1).


Construction of condition specific subnetworks

Public biological network is a powerful resource that help to understand cellular mechanisms through proteins and their interaction. Among them, STRING protein-protein interaction (PPI) network is a well-known protein interaction networks that comprehensively reflects functional and physical interactions of proteins using public available resources 24 . However, since STRING predicted the interaction with an approximate probability (called confidence score in STRING) that predicted link exists between two enzymes in the same metabolic map in the KEGG, there is a limit to measuring and interpreting phenotypic change specifically for given data using the whole network 51 . Therefore, we constructed give gene expression data specific subnetworks using two network analysis algorithms: network propagation algorithm and community detection algorithm.


Re-defining of gene interactions using network propagation

In the public biological network, STRING PPI network, we used largest connected component network with a threshold of edge weight as 0.7 to use a template network with high confidence and low false positive 52 . To re-define the genetic relationships, that is, edge weight in the template network by reflecting the properties of the given gene expression data, we used a network propagation algorithm 53 . Network propagation is a method that can show the impact across the network through random and repetitive walks with nodes connected to the seed nodes, starting with given seed nodes. Here, we used genes with large expression difference between the normal and query samples as seed nodes. For initial probability distribution P 0 and adjacency matrix W, the probability distribution as follows:
P T t+1 = (1 − α) W P T t + α P T 0 (1)
where t is the propagation step and α is restart rate that describes the trade-off between prior information and network smoothing.

In this paper, we used the random walk with restart (RWR)-based method for prioritizing candidate gens using global network distance measurement and random walk analysis to define the similarity of network 21 . As result of the RWR-based method, we obtained a propagation or diffusion score of each gene. And then, we constructed a network with given data specific edge weight by re-defining the interaction of two nodes as the product of the propagation scores of the two interacted nodes.


Gene clustering using community detection

To perform gene clustering by reflecting the properties of given data to a large-scale network, we used the Louvain method on a network with re-defining edge weights a network propagation algorithm 20 . In the Louvain method, the modularity of the weighted graph is defined as: for gene v and w in network node set N,
Q = 1 2m ∑ v,w∈N A vw − k v k w 2m δ (c v , c w )(2)
where m is the sum of all edge weights in the network, A vw is an edge weight between genes v and w, k v is the sum of edge weights with neighbors of the node v, δ is Kronecker delta function and c v is the communities of the genes. Using the above modularity definition, the Louvain method first found small communities by optimizing modularity locally on the entire node, then grouped each small community into one node and repeated this method to perform community detection. As a result of a community detection algorithm, we obtained clusters of genes that maximizes modularity. Finally, we defined given data specific subnetworks by constraining the network size, here we constrained the number of nodes and edge weight, and through this result, the complex gene space is reduced to few tens of subnetwork dimension.


9/13

Map into a metric space For each subnetwork, we measured the phenotypic changes of each sample compare to normal sample from two perspectives: network level Jensen-Shannon divergence (JSD) and network structure level importance. By combining these two measured values, each sample is mapped into a metric space generated by subnetworks in the form of vector.


Calculation of network level JSD

In information theory, JSD is a method of measuring the difference between two probability distributions, with symmetrical and finite values of Kullback-Leibler divergence (KLD). Motivated by the 18 , we measured how different the influence of genes on neighboring genes in network was compared to normal, based on information theory. For each gene in the network, the probability distribution of the gene v is defined using the expression value of the neighbors N v :
P(v) = p w = e w ∑ N v e where w ∈ N v(3)
where e w is expression value of gene w in N v . Then, the KLD of gene v between normal sample distribution P N (v) = p N (w)wherew ∈ N v and query sample distribution P Q (v) = p Q (w)where|w ∈ N v is defined as:
KLD v P N P Q = KLD v P N (v) P Q (v) = ∑ w∈N v p N (w) log p N (w) p Q (w) .(4)
Utilizing the KLD defined in the network, we defined the network level JSD of gene v between normal and query as follows:
JSD v P N P Q = 1 2 KLD v P N P M + 1 2 KLD v P Q P M(5)
where P M = 1 2 P N + P Q .


Calculation of network structure level importance

When defining the phenotypic change of a query sample, the probabilistic change based on information theory calculated the change of the same value for gene set with different expression but the same proportion. To compensate for this, we measured the importance of each gene in the network structure. Closeness centrality of node is a value that evaluate the degree of the centrality of the node in the network and is defined as the reciprocal for the sum of shortest path lengths between node and all other nodes in the network:
CC v = |N| − 1 ∑ w∈N/{v} d(v, w)(6)
where N is set of nodes in network, |N| is the number of nodes and d(v, w) is shortest pathway between v and w. We used the centrality obtained by each gene in the network as the importance of the gene in a network structure.


Calculation of NetJSD

In the subnetworks constructed utilizing the properties of given data in the template network, we defined the phenotypic change in each gene of the subnetwork as the product of the two level changes, network level JSD and network structure level importance. And then, the average value of the change value of all genes in the subnetwork was defined as the phenotypic change of sample in the subnetwork NetJSD:
NetJSD = 1 |N| ∑ v∈N CC v × JSD v P N P Q .(7)
As a result, we computed NetJSD on all subnetworks and then mapped a single sample S into a metric space generated by subnetworks in the form of following vector:
S = [NetJSD 1 , · · · , NetJSD M ](8)
where M is the number of subnetworks.